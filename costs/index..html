
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cost Breakdown Dashboard</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    
    <!-- Prop Types (Required for Recharts UMD) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>

    <!-- Recharts -->
    <script src="https://unpkg.com/recharts@2.12.0/umd/Recharts.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        const { 
            PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend, 
            BarChart, Bar, XAxis, YAxis, CartesianGrid 
        } = Recharts;

        // --- Icons (Inline SVGs to remove dependency on lucide-react module) ---
        const DollarSign = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
        );
        const Wallet = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"></path><path d="M4 6v12c0 1.1.9 2 2 2h14v-4"></path><path d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z"></path></svg>
        );
        const TrendingUp = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>
        );

        // --- Main Component ---
        const CostDashboard = () => {
            // State for toggles
            const [isNonprofit, setIsNonprofit] = useState(false);
            const [usageLevel, setUsageLevel] = useState('high'); // 'low' or 'high'

            // Data Configuration
            const items = [
                { name: 'Claude', category: 'AI Models', standard: 100, nonprofit: 40, recurring: 'Monthly' },
                { name: 'Google AI Pro', category: 'AI Models', standard: 20, nonprofit: 20, recurring: 'Monthly' },
                { name: 'Perplexity Pro', category: 'AI Models', standard: 20, nonprofit: 20, recurring: 'Monthly' },
                { name: 'Grok', category: 'AI Models', standard: 30, low: 0, recurring: 'Monthly (Variable)' },
                { name: 'Photoroom', category: 'Creative Tools', standard: 10, nonprofit: 10, recurring: 'Monthly' },
                { name: 'Setapp', category: 'Productivity', standard: 15, nonprofit: 15, recurring: 'Monthly' },
                { name: 'Beeper', category: 'Communication', standard: 10, nonprofit: 10, recurring: 'Monthly' },
                { name: 'Google Voice', category: 'Communication', standard: 10, low: 0, recurring: 'Monthly (Variable)' },
                { name: 'Skool', category: 'Education/Community', standard: 9, nonprofit: 9, recurring: 'Monthly' },
                { name: 'GitHub Pages', category: 'Infrastructure', standard: 5, nonprofit: 5, recurring: 'Monthly' },
                { name: 'Spaceship Email', category: 'Infrastructure', standard: 1, nonprofit: 1, recurring: 'Annual ($12/yr)' },
                { name: 'Spaceship Domain', category: 'Infrastructure', standard: 0.75, nonprofit: 0.75, recurring: 'Annual ($9/yr)' },
            ];

            // Calculate costs based on state
            const calculatedData = useMemo(() => {
                return items.map(item => {
                let monthlyCost = isNonprofit && item.nonprofit !== undefined ? item.nonprofit : item.standard;
                
                // Handle variable pricing (Grok, Google Voice)
                if (usageLevel === 'low' && item.low !== undefined) {
                    monthlyCost = item.low;
                }

                return {
                    ...item,
                    monthly: monthlyCost,
                    annual: monthlyCost * 12
                };
                }).sort((a, b) => b.monthly - a.monthly);
            }, [isNonprofit, usageLevel]);

            const totalMonthly = calculatedData.reduce((acc, item) => acc + item.monthly, 0);
            const totalAnnual = totalMonthly * 12;

            // Data for Charts
            const pieData = calculatedData.filter(i => i.monthly > 0).map(item => ({
                name: item.name,
                value: item.monthly
            }));

            const COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#ec4899', '#6366f1', '#14b8a6', '#f97316', '#84cc16'];

            // Scenarios for Comparison Chart
            const scenarios = [
                { name: 'Std (Max)', cost: 230.75 }, // Approx high
                { name: 'Std (Min)', cost: 190.75 }, // Approx low
                { name: 'Nonprofit (Max)', cost: 170.75 },
                { name: 'Nonprofit (Min)', cost: 130.75 },
            ];

            return (
                <div className="min-h-screen bg-slate-50 p-4 md:p-8 font-sans text-slate-800">
                <div className="max-w-7xl mx-auto space-y-6">
                    
                    {/* Header */}
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <div>
                        <h1 className="text-2xl font-bold text-slate-900">Monthly Cost Breakdown</h1>
                        <p className="text-slate-500 mt-1">Subscription & Infrastructure Analysis</p>
                    </div>
                    <div className="mt-4 md:mt-0 flex flex-col items-end gap-2">
                        <div className="flex items-center gap-3 bg-slate-100 p-1 rounded-lg">
                        <button 
                            onClick={() => setIsNonprofit(false)}
                            className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${!isNonprofit ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                        >
                            Standard
                        </button>
                        <button 
                            onClick={() => setIsNonprofit(true)}
                            className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${isNonprofit ? 'bg-white text-green-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                        >
                            Nonprofit
                        </button>
                        </div>
                        <div className="flex items-center gap-2 text-sm text-slate-600">
                        <span className="font-medium">Variable Usage:</span>
                        <select 
                            value={usageLevel} 
                            onChange={(e) => setUsageLevel(e.target.value)}
                            className="bg-white border border-slate-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-200 outline-none"
                        >
                            <option value="high">High (Paid Grok/Voice)</option>
                            <option value="low">Low (Free Grok/Voice)</option>
                        </select>
                        </div>
                    </div>
                    </div>

                    {/* KPI Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4">
                        <div className="p-3 bg-blue-50 rounded-full text-blue-600">
                        <DollarSign size={24} />
                        </div>
                        <div>
                        <p className="text-sm font-medium text-slate-500">Total Monthly Cost</p>
                        <p className="text-3xl font-bold text-slate-900">${totalMonthly.toFixed(2)}</p>
                        </div>
                    </div>
                    
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4">
                        <div className="p-3 bg-indigo-50 rounded-full text-indigo-600">
                        <Wallet size={24} />
                        </div>
                        <div>
                        <p className="text-sm font-medium text-slate-500">Total Annual Cost</p>
                        <p className="text-3xl font-bold text-slate-900">${totalAnnual.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</p>
                        </div>
                    </div>

                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4">
                        <div className={`p-3 rounded-full ${isNonprofit ? 'bg-green-50 text-green-600' : 'bg-orange-50 text-orange-600'}`}>
                        <TrendingUp size={24} />
                        </div>
                        <div>
                        <p className="text-sm font-medium text-slate-500">Active Scenario</p>
                        <p className="text-lg font-semibold text-slate-900">
                            {isNonprofit ? 'Nonprofit Rates' : 'Standard Rates'}
                        </p>
                        <p className="text-xs text-slate-500">
                            {usageLevel === 'high' ? 'Full features enabled' : 'Free tiers utilized'}
                        </p>
                        </div>
                    </div>
                    </div>

                    {/* Charts Section */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    
                    {/* Pie Chart: Where is the money going? */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 className="text-lg font-semibold text-slate-800 mb-4">Monthly Cost Composition</h3>
                        <div className="h-80 w-full">
                        <ResponsiveContainer width="100%" height="100%">
                            <PieChart>
                            <Pie
                                data={pieData}
                                cx="50%"
                                cy="50%"
                                innerRadius={60}
                                outerRadius={100}
                                fill="#8884d8"
                                paddingAngle={5}
                                dataKey="value"
                            >
                                {pieData.map((entry, index) => (
                                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                ))}
                            </Pie>
                            <Tooltip formatter={(value) => `$${value}`} />
                            <Legend layout="vertical" verticalAlign="middle" align="right" />
                            </PieChart>
                        </ResponsiveContainer>
                        </div>
                    </div>

                    {/* Bar Chart: Scenario Comparison */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 className="text-lg font-semibold text-slate-800 mb-4">Scenario Comparison (Monthly)</h3>
                        <div className="h-80 w-full">
                        <ResponsiveContainer width="100%" height="100%">
                            <BarChart
                            data={scenarios}
                            margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
                            >
                            <CartesianGrid strokeDasharray="3 3" vertical={false} />
                            <XAxis dataKey="name" tick={{fontSize: 12}} />
                            <YAxis tickFormatter={(val) => `$${val}`} />
                            <Tooltip cursor={{fill: '#f1f5f9'}} formatter={(value) => `$${value}`} />
                            <Bar dataKey="cost" fill="#6366f1" radius={[4, 4, 0, 0]}>
                                {scenarios.map((entry, index) => (
                                    <Cell key={`cell-${index}`} fill={entry.name.includes('Nonprofit') ? '#10b981' : '#3b82f6'} />
                                ))}
                            </Bar>
                            </BarChart>
                        </ResponsiveContainer>
                        </div>
                        <p className="text-xs text-slate-500 text-center mt-2">
                        Comparing Max/Min costs for Standard vs Nonprofit tiers
                        </p>
                    </div>
                    </div>

                    {/* The "Sheet": Detailed Table */}
                    <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div className="px-6 py-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center">
                        <h3 className="text-lg font-semibold text-slate-800">Detailed Expense Sheet</h3>
                        <span className="text-xs font-medium px-2 py-1 bg-slate-200 rounded text-slate-600">
                        {calculatedData.length} Items
                        </span>
                    </div>
                    <div className="overflow-x-auto">
                        <table className="w-full text-left border-collapse">
                        <thead>
                            <tr className="bg-slate-50 text-slate-500 text-sm border-b border-slate-200">
                            <th className="px-6 py-3 font-semibold">Service / Tool</th>
                            <th className="px-6 py-3 font-semibold">Category</th>
                            <th className="px-6 py-3 font-semibold">Billing Frequency</th>
                            <th className="px-6 py-3 font-semibold text-right">Monthly</th>
                            <th className="px-6 py-3 font-semibold text-right">Annually</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-slate-100">
                            {calculatedData.map((item, index) => (
                            <tr key={index} className="hover:bg-slate-50 transition-colors">
                                <td className="px-6 py-4 font-medium text-slate-900 flex items-center gap-3">
                                <div className="w-2 h-2 rounded-full" style={{backgroundColor: COLORS[index % COLORS.length]}}></div>
                                {item.name}
                                </td>
                                <td className="px-6 py-4 text-slate-600 text-sm">
                                <span className="bg-slate-100 px-2 py-1 rounded text-xs border border-slate-200">
                                    {item.category}
                                </span>
                                </td>
                                <td className="px-6 py-4 text-slate-500 text-sm">{item.recurring}</td>
                                <td className="px-6 py-4 text-right font-medium text-slate-900">
                                ${item.monthly.toFixed(2)}
                                {item.monthly === 0 && <span className="ml-2 text-xs text-green-600 font-normal">(Free Tier)</span>}
                                </td>
                                <td className="px-6 py-4 text-right text-slate-600">
                                ${item.annual.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                                </td>
                            </tr>
                            ))}
                        </tbody>
                        <tfoot className="bg-slate-50 border-t border-slate-200 font-semibold text-slate-900">
                            <tr>
                            <td colSpan="3" className="px-6 py-4 text-right">TOTAL</td>
                            <td className="px-6 py-4 text-right text-lg">${totalMonthly.toFixed(2)}</td>
                            <td className="px-6 py-4 text-right text-lg">${totalAnnual.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                            </tr>
                        </tfoot>
                        </table>
                    </div>
                    </div>

                    {/* Footer Notes */}
                    <div className="text-xs text-slate-400 p-2 text-center">
                    * Annual items (Spaceship Domain/Email) are amortized into the monthly cost column for accurate budgeting.
                    </div>

                </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CostDashboard />);
    </script>
</body>
</html>
